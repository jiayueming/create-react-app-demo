{"ast":null,"code":"var _dec,\n    _class,\n    _jsxFileName = \"/Users/nuoee/Desktop/react-demo/src/pages/purchase/index.js\";\n\nimport React from 'react';\nimport http from '../../utils/http';\nimport { ERR_OK } from '../../utils/config';\nimport { connect } from 'react-redux';\nimport { createOrder } from '../../redux/exchange.redux';\nimport \"./index.css\";\nlet PurChase = (_dec = connect(state => state.exchange, {\n  createOrder\n}), _dec(_class = class PurChase extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dealMoney: '',\n      dealAmount: '',\n      noNeed: true,\n      coinName: '',\n      coinId: '',\n      coinList: [],\n      currentIndex: 0,\n      currentWay: 0,\n      dealPrice: '',\n      payWays: [{\n        name: '支付宝'\n      }, {\n        name: '微信'\n      }, {\n        name: '银行卡'\n      }],\n      limit: ''\n    };\n    this.submit = this.submit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  componentDidMount() {\n    let token = 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NTkwMzI1MjUsInVzZXJfbmFtZSI6IjE1NjE3OTA3MzQwIiwianRpIjoiOWExNTc0OTItMzk3NS00ZTEzLWIwYTQtMzdlZTcyN2MwZDc4IiwiY2xpZW50X2lkIjoidXNlci1zZXJ2aWNlIiwic2NvcGUiOlsic2VydmljZSJdfQ.VcwvCGArdxnqiLvvvjuoBFsBdVgQRKpSSP6Hg46Gxnnnp8bIanvoEc6Wh4ZL6JskSf-pAY0uoiP7igPNuBUVfns-e6S5HWRAsge_AHX4glvz-ozlJjk01JpM5nem1k1QxW_cnhZ82tB7g_Q8AJ8EOhe38OmjDHrLrCqQQ3njGM2FKda9Az6nrEOzaao8tyegsO3SBIpN70cyCs8RSFepS278R-ePWYmVeCLT98J22GVzVeyisOUkLrhuNeRJqN12supbcZ81kupY60TkO5IGPo2Vo1KKkiMZM6KeEcZiqZ4wQvzNu6g7l1fna1SBctQCN1YthfRX4gkjsaKG0fgwvw';\n    sessionStorage.setItem('token', token);\n    this.getCoinList();\n  }\n\n  onChange(key, val) {\n    this.setState({\n      [key]: val\n    });\n  }\n\n  switchItem(item, index) {\n    this.setState({\n      currentIndex: index,\n      coinId: item.coinId,\n      coinName: item.coinName,\n      dealMoney: '',\n      dealAmount: ''\n    });\n    setTimeout(() => {\n      this.getPrice();\n    }, 0);\n  }\n\n  choose(index) {\n    this.setState({\n      currentWay: index\n    });\n  }\n\n  getCoinList() {\n    http.get('bottom/coin/coinlist', {\n      trade: true\n    }, this.noNeed).then(res => {\n      if (res.code === ERR_OK) {\n        this.setState({\n          coinList: res.data,\n          coinId: res.data[0].coinId,\n          coinName: res.data[0].coinName\n        });\n        this.getPrice();\n      }\n    });\n  }\n\n  getPrice() {\n    http.get('market/otcmarket/getnewprice', {\n      coinId: this.state.coinId\n    }, this.noNeed).then(res => {\n      if (res.code === ERR_OK) {\n        this.setState({\n          dealPrice: res.data.cnyPrice\n        });\n      }\n    });\n  }\n\n  getLimit() {\n    http.get('bottom/config/getlimit', {}, this.noNeed).then(res => {\n      if (res.code === ERR_OK) {\n        this.setState({\n          limit: JSON.parse(res.data.value)\n        });\n      }\n    });\n  }\n\n  handleChange(e) {\n    let _this$state = this.state,\n        dealAmount = _this$state.dealAmount,\n        dealMoney = _this$state.dealMoney; // 用name来区分不同的文字框输入\n\n    if (e.target.getAttribute('name') === 'amount') {\n      dealAmount = e.target.value;\n\n      if (dealAmount) {\n        dealMoney = (dealAmount * this.state.dealPrice).toFixed(2);\n      } else {\n        dealMoney = '';\n      }\n    } else {\n      dealMoney = e.target.value;\n\n      if (dealMoney) {\n        dealAmount = (dealMoney / this.state.dealPrice).toFixed(6);\n      } else {\n        dealAmount = '';\n      }\n    } // 改变state值，文字框会随著更动\n\n\n    this.setState({\n      dealAmount: dealAmount,\n      dealMoney: dealMoney\n    });\n  }\n\n  submit() {\n    window.scroll(0, 0);\n\n    if (this.state.dealAmount <= 0 || this.state.dealMoney <= 0) {\n      console.log('请输入购买金额');\n      return;\n    } else if (this.state.dealMoney < 1) {\n      console.log(\"\\u8D2D\\u4E70\\u91D1\\u989D\\u4E0D\\u5F97\\u4F4E\\u4E8E\".concat(this.state.limit.min, \"\\u5143\"));\n      return;\n    } else if (this.state.dealMoney > this.state.limit.max) {\n      console.log(\"\\u4ECA\\u65E5\\u9650\\u989D\".concat(this.state.limit.max));\n      return;\n    }\n\n    let buyType = this.state.currentWay === 0 ? '1' : this.state.currentWay === 1 ? '3' : '2';\n    let data = {\n      dealAmount: this.state.dealAmount,\n      dealPrice: this.state.dealPrice,\n      dealVol: this.state.dealMoney,\n      buyType: buyType,\n      currencyType: this.state.coinName,\n      coinId: this.state.coinId,\n      unixTimestamps: new Date().getTime()\n    };\n  }\n\n  render() {\n    // const path = this.props.location.pathname\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, this.state.coinList.map((val, index) => {\n      return React.createElement(\"p\", {\n        key: index,\n        onClick: () => this.switchItem(val, index),\n        className: index === this.state.currentIndex ? \"active\" : null,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, val.coinName);\n    })), React.createElement(\"div\", {\n      className: \"main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"\\u5355\\u4EF7\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"money\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, this.state.dealPrice), React.createElement(\"span\", {\n      className: \"unit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, \"CNY\"))), React.createElement(\"div\", {\n      className: \"line\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"buy\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"choose\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"\\u8D2D\\u4E70\\u6570\\u91CF\"), React.createElement(\"p\", {\n      className: \"input-box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"\\u8D2D\\u4E70\\u6570\\u91CF\",\n      value: this.state.dealAmount,\n      onChange: this.handleChange,\n      name: \"amount\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"coin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, this.state.coinName))), React.createElement(\"div\", {\n      className: \"transfer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: require(\"../../common/image/transformation@2x.png\"),\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"choose\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"\\u4EF7\\u683C\"), React.createElement(\"p\", {\n      className: \"input-box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"\\u8D2D\\u4E70\\u91D1\\u989D\",\n      value: this.state.dealMoney,\n      onChange: this.handleChange,\n      name: \"money\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"coin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"CNY\")))), React.createElement(\"div\", {\n      className: \"payWays\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, this.state.payWays.map((item, index) => {\n      return React.createElement(\"p\", {\n        key: index,\n        onClick: () => this.choose(index),\n        className: index === this.state.currentWay ? \"activePay\" : null,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, item.name);\n    })), React.createElement(\"p\", {\n      className: \"warn-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"\\u6BCF\\u65E5\\u9650\\u989D\\uFF1A \\uFFE51.00~\\uFFE52,000.00\"), React.createElement(\"button\", {\n      className: \"buyBtn\",\n      onClick: this.submit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, \"\\u7ACB\\u5373\\u8D2D\\u4E70\"), React.createElement(\"p\", {\n      className: \"warn-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, \"\\u4EA4\\u6613\\u624B\\u7EED\\u8D39\\u5168\\u514D\")));\n  }\n\n}) || _class);\nexport default PurChase;","map":{"version":3,"sources":["/Users/nuoee/Desktop/react-demo/src/pages/purchase/index.js"],"names":["React","http","ERR_OK","connect","createOrder","PurChase","state","exchange","Component","constructor","props","dealMoney","dealAmount","noNeed","coinName","coinId","coinList","currentIndex","currentWay","dealPrice","payWays","name","limit","submit","bind","handleChange","componentDidMount","token","sessionStorage","setItem","getCoinList","onChange","key","val","setState","switchItem","item","index","setTimeout","getPrice","choose","get","trade","then","res","code","data","cnyPrice","getLimit","JSON","parse","value","e","target","getAttribute","toFixed","window","scroll","console","log","min","max","buyType","dealVol","currencyType","unixTimestamps","Date","getTime","render","map","require"],"mappings":"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","sourcesContent":["import React from 'react'\nimport http from '../../utils/http'\nimport {ERR_OK} from '../../utils/config'\nimport {connect} from 'react-redux'\nimport {createOrder} from '../../redux/exchange.redux'\nimport \"./index.css\";\n@connect(\n\tstate=>state.exchange,\n\t{createOrder}\n)\nclass PurChase extends React.Component{\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n            dealMoney:'',\n            dealAmount: '',\n\t\t\tnoNeed: true,\n\t\t\tcoinName:'',\n            coinId:'',\n            coinList: [],\n            currentIndex: 0,\n            currentWay: 0,\n            dealPrice: '',\n            payWays: [\n                {name: '支付宝'},\n                {name: '微信'},\n                {name: '银行卡'}\n            ],\n            limit: ''\n        }\n        this.submit = this.submit.bind(this)\n        this.handleChange = this.handleChange.bind(this)\n    }\n    componentDidMount () {\n        let token = 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NTkwMzI1MjUsInVzZXJfbmFtZSI6IjE1NjE3OTA3MzQwIiwianRpIjoiOWExNTc0OTItMzk3NS00ZTEzLWIwYTQtMzdlZTcyN2MwZDc4IiwiY2xpZW50X2lkIjoidXNlci1zZXJ2aWNlIiwic2NvcGUiOlsic2VydmljZSJdfQ.VcwvCGArdxnqiLvvvjuoBFsBdVgQRKpSSP6Hg46Gxnnnp8bIanvoEc6Wh4ZL6JskSf-pAY0uoiP7igPNuBUVfns-e6S5HWRAsge_AHX4glvz-ozlJjk01JpM5nem1k1QxW_cnhZ82tB7g_Q8AJ8EOhe38OmjDHrLrCqQQ3njGM2FKda9Az6nrEOzaao8tyegsO3SBIpN70cyCs8RSFepS278R-ePWYmVeCLT98J22GVzVeyisOUkLrhuNeRJqN12supbcZ81kupY60TkO5IGPo2Vo1KKkiMZM6KeEcZiqZ4wQvzNu6g7l1fna1SBctQCN1YthfRX4gkjsaKG0fgwvw'\n        sessionStorage.setItem('token', token)\n        this.getCoinList()\n    }\n\tonChange(key,val){\n\t\tthis.setState({\n\t\t\t[key]:val\n\t\t})\n    }\n    switchItem (item, index) {\n        this.setState({\n            currentIndex : index,\n            coinId : item.coinId,\n            coinName : item.coinName,\n            dealMoney : '',\n            dealAmount : ''\n        })\n        setTimeout(() => {\n            this.getPrice()\n        }, 0)\n    }\n    choose (index) {\n        this.setState({\n\t\t\tcurrentWay:index\n        })\n    }\n    getCoinList () {\n        http.get('bottom/coin/coinlist', {\n          trade: true\n        }, this.noNeed).then(res => {\n          if (res.code === ERR_OK) {\n            this.setState({\n                coinList : res.data,\n                coinId : res.data[0].coinId,\n                coinName : res.data[0].coinName\n            })\n            this.getPrice()\n          }\n        })\n    }\n    getPrice () {\n        http.get('market/otcmarket/getnewprice', {\n          coinId: this.state.coinId\n        }, this.noNeed).then(res => {\n          if (res.code === ERR_OK) {\n            this.setState({\n                dealPrice : res.data.cnyPrice\n            })\n          }\n        })\n    }\n    getLimit () {\n        http.get('bottom/config/getlimit', {}, this.noNeed).then(res => {\n          if (res.code === ERR_OK) {\n            this.setState({\n                limit : JSON.parse(res.data.value)\n            })\n          }\n        })\n    }\n    handleChange (e) {\n        let { dealAmount, dealMoney } = this.state\n        // 用name来区分不同的文字框输入\n        if (e.target.getAttribute('name') === 'amount') {\n            dealAmount = e.target.value\n            if (dealAmount) {\n                dealMoney = (dealAmount * this.state.dealPrice).toFixed(2)\n            } else {\n                dealMoney = ''\n            }\n        } else {\n            dealMoney = e.target.value\n            if (dealMoney) {\n                dealAmount = (dealMoney / this.state.dealPrice).toFixed(6)\n            } else {\n                dealAmount = ''\n            }\n        }\n        // 改变state值，文字框会随著更动\n        this.setState({\n            dealAmount: dealAmount,\n            dealMoney: dealMoney\n        })\n    }\n    submit () {\n        window.scroll(0, 0)\n        if (this.state.dealAmount <= 0 || this.state.dealMoney <= 0) {\n          console.log('请输入购买金额')\n          return\n        } else if (this.state.dealMoney < 1) {\n          console.log(`购买金额不得低于${this.state.limit.min}元`)\n          return\n        } else if (this.state.dealMoney > this.state.limit.max) {\n          console.log(`今日限额${this.state.limit.max}`)\n          return\n        }\n        let buyType = this.state.currentWay === 0 ? '1' : this.state.currentWay === 1 ? '3' : '2'\n        let data = {\n            dealAmount: this.state.dealAmount,\n            dealPrice: this.state.dealPrice,\n            dealVol: this.state.dealMoney,\n            buyType: buyType,\n            currencyType: this.state.coinName,\n            coinId: this.state.coinId,\n            unixTimestamps: new Date().getTime()\n        }\n        \n    }\n\trender(){\n        // const path = this.props.location.pathname\n\t\treturn (\n\t\t\t<div className=\"container\">\n                <header>\n                    {\n                        this.state.coinList.map((val, index) => {\n                            return <p key={index}  onClick={() => this.switchItem(val, index)}\n                            className={index===this.state.currentIndex?\"active\":null}>{val.coinName}</p>\n                        })\n                    }\n                </header>\n                <div className=\"main\">\n                    <div className=\"price\">\n                        <p>单价</p>\n                        <p><span className=\"money\">{this.state.dealPrice}</span><span className=\"unit\">CNY</span></p>\n                    </div>\n                    <div className=\"line\"></div>\n                    <div className=\"buy\">\n                        <div className=\"choose\">\n                            <p>购买数量</p>\n                            <p className=\"input-box\">\n                            <input type=\"text\" placeholder=\"购买数量\" value={this.state.dealAmount} onChange={this.handleChange} name=\"amount\"/>\n                            <span className=\"coin\">{this.state.coinName}</span></p>\n                        </div>\n                        <div className=\"transfer\"><img src={require(\"../../common/image/transformation@2x.png\")} alt=\"\" /></div>\n                        <div className=\"choose\">\n                            <p>价格</p>\n                            <p className=\"input-box\">\n                            <input type=\"text\" placeholder=\"购买金额\" value={this.state.dealMoney} onChange={this.handleChange} name=\"money\"/>\n                            <span className=\"coin\">CNY</span></p>\n                        </div>\n                    </div>\n                    <div className=\"payWays\">\n                        {\n                            this.state.payWays.map((item, index) => {\n                                return <p key={index} onClick={() => this.choose(index)}\n                                className={index===this.state.currentWay?\"activePay\":null}>{item.name}</p>\n                            })\n                        }\n                    </div>\n                    <p className=\"warn-text\">每日限额： ￥1.00~￥2,000.00</p>\n                    <button className=\"buyBtn\" onClick={this.submit}>立即购买</button>\n                    <p className=\"warn-text\">交易手续费全免</p>\n                </div>\n\t\t\t</div>\t\n\t\t)\n\t}\n}\n\nexport default PurChase"]},"metadata":{},"sourceType":"module"}